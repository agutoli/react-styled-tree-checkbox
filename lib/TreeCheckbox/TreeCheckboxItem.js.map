{"version":3,"sources":["../../src/TreeCheckbox/TreeCheckboxItem.js"],"names":["TreeCheckboxItem","props","checkedNodes","node","children","filter","x","checked","map","value","state","selectedValues","Set","collapsed","onToggleCollape","_onToggleCollape","bind","onChangeChildField","_onChangeChildField","onToggleSelectAll","_onToggleSelectAll","setState","target","parseInt","onChange","Array","from","child","add","clear","event","unselectAllItems","selectAllItems","showNativeStyle","has","childLabelRenderer","showToggleArrow","showToggleText","isAllSelected","size","length","icon","rootLabelRenderer","renderChildren","setTimeout","React","PureComponent","propTypes","PropTypes","func","bool","showChanges","defaultProps"],"mappings":"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","file":"TreeCheckboxItem.js","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport {FormattedMessage} from 'react-intl';\n\nimport ItemWrapper from './partials/ItemWrapper'\nimport CollapseText from './partials/CollapseText'\nimport ArrowCollapse from './partials/ArrowCollapse'\n\nimport InputCheckbox from './partials/InputCheckbox'\nimport RootNodeWrapper from './partials/RootNodeWrapper'\nimport ChildNodeWrapper from './partials/ChildNodeWrapper'\nimport ChildrenNodeWrapper from './partials/ChildrenNodeWrapper'\n\nimport rootLabelRenderer from './renderers/rootLabelRenderer'\nimport childLabelRenderer from './renderers/childLabelRenderer'\n\nclass TreeCheckboxItem extends React.PureComponent {\n  constructor(props) {\n    super(props)\n\n    const checkedNodes = props.node.children.filter(x => x.checked).map(x => x.value)\n\n    this.state = {\n      selectedValues: new Set(checkedNodes),\n      collapsed: props.collapsed\n    }\n\n    this.onToggleCollape = this._onToggleCollape.bind(this)\n    this.onChangeChildField = this._onChangeChildField.bind(this)\n    this.onToggleSelectAll = this._onToggleSelectAll.bind(this)\n  }\n\n  _onToggleCollape() {\n    this.setState({\n      collapsed: !this.state.collapsed\n    })\n  }\n\n  _onChangeChildField({ target }) {\n    const { node } = this.props\n    const { selectedValues } = this.state\n    selectedValues[target.checked ? 'add': 'delete'](parseInt(target.value))\n    this.setState({ selectedValues: new Set(selectedValues) }, () => {\n      this.props.onChange(node.value, Array.from(this.state.selectedValues))\n    })\n  }\n\n  selectAllItems(node) {\n    const { selectedValues } = this.state\n    node.children.map((child) => selectedValues.add(parseInt(child.value)))\n    this.setState({ selectedValues: new Set(selectedValues) })\n  }\n\n  unselectAllItems(node) {\n    const { selectedValues } = this.state\n    selectedValues.clear()\n    this.setState({ selectedValues: new Set(selectedValues) })\n  }\n\n  _onToggleSelectAll(event) {\n    const { node } = this.props\n    const { selectedValues } = this.state\n\n    if (!event.target.checked) {\n      this.unselectAllItems(node)\n    }\n\n    if (event.target.checked) {\n      this.selectAllItems(node)\n    }\n\n    this.props.onToggleSelectAll(event)\n    this.props.onChange(node.value, Array.from(this.state.selectedValues))\n  }\n\n  renderChildren(children) {\n    const { showNativeStyle } = this.props\n    const { collapsed, selectedValues } = this.state\n    return (\n      <ChildrenNodeWrapper data-children-node-wrapper key=\"children-node-wrapper\">\n        {children.map((node) => (\n          <ChildNodeWrapper key={node.value} data-child-node-wrapper>\n          {showNativeStyle ?\n            <input\n              id={`child-node-${node.value}`}\n              type=\"checkbox\"\n              value={node.value}\n              onChange={this.onChangeChildField} /> :\n            <InputCheckbox\n              id={`child-node-${node.value}`}\n              value={node.value}\n              checked={selectedValues.has(node.value)}\n              onChange={this.onChangeChildField} />\n            }\n            {this.props.childLabelRenderer(node)}\n          </ChildNodeWrapper>\n        ))}\n      </ChildrenNodeWrapper>\n    )\n  }\n\n  componentWillReceiveProps({ collapsed }) {\n    this.setState({ collapsed })\n  }\n\n  render() {\n    const { collapsed, selectedValues } = this.state\n\n    const {\n      node,\n      showToggleArrow,\n      showToggleText,\n      showNativeStyle\n    } = this.props\n\n    const isAllSelected = selectedValues.size === node.children.length\n\n    return (\n      <ItemWrapper collapsed={collapsed}>\n        <RootNodeWrapper key={node.value} data-root-node-wrapper>\n          {showToggleArrow ? <ArrowCollapse collapsed={collapsed} onClick={this.onToggleCollape} /> : null}\n          {showNativeStyle ?\n            <input id={`root-node-${node.value}`} type=\"checkbox\" value={node.value} onChange={this.onToggleSelectAll} /> :\n            <InputCheckbox\n              id={`root-node-${node.value}`}\n              value={node.value}\n              checked={isAllSelected}\n              onChange={this.onToggleSelectAll} />\n          }\n          {node.icon}\n          {this.props.rootLabelRenderer(node, this.props, {\n            onToggleCollape: this.onToggleCollape,\n            onToggleSelectAll: this.onToggleSelectAll\n          })}\n          <CollapseText\n            className=\"collapse-expand-menu\"\n            onClick={this.onToggleCollape}>\n            {showToggleText ? collapsed ? (\n              <FormattedMessage id=\"Expand\" defaultMessage={`Expand`} />\n            ) : (\n              <FormattedMessage id=\"Collapse\" defaultMessage={`Collapse`} />\n            ): null}\n          </CollapseText>\n        </RootNodeWrapper>\n        {this.renderChildren(node.children)}\n      </ItemWrapper>\n    )\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      if (this.props.node.checked) {\n        this.selectAllItems(this.props.node)\n      }\n    }, 1)\n  }\n}\n\nTreeCheckboxItem.propTypes = {\n  onChange: PropTypes.func,\n  collapsed: PropTypes.bool,\n  showChanges: PropTypes.bool,\n  showToggleArrow: PropTypes.bool,\n  showToggleText: PropTypes.bool,\n  rootLabelRenderer: PropTypes.func,\n  childLabelRenderer: PropTypes.func,\n  onToggleSelectAll: PropTypes.func,\n}\n\nTreeCheckboxItem.defaultProps = {\n  onChange: () => {},\n  rootLabelRenderer,\n  childLabelRenderer,\n  collapsed: false,\n  showChanges: true,\n  showToggleArrow: false,\n  showToggleText: false,\n  showNativeStyle: false,\n  onToggleSelectAll: () => {}\n}\n\nexport default TreeCheckboxItem\n"]}